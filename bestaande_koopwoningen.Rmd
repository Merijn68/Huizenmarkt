---
title: "Ontwikkeling huizenmarkt in Nederland"
author:
- Merijn van Miltenburg
date: "25/02/2021"
output: 
    html_document:
      code_folding: hide
      toc: true
      toc_depth: 2
      number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# Inleiding

De macro economen van de Volksbank hebben als taak de toestand in de wereld toe te lichten voor directie en beleidsmakers. Een belangrijk onderdeel daarvan heeft betrekking met de ontwikkeling van de hypotheekmarkt in Nederland. De huizenprijzen en aantallen verkochte woningen zijn belangrijke indicatoren voor de ontwikkeling van de hypotheekmarkt.

In deze analyse volg ik de PPDAC cyclus. In de volgende paragraaf wordt de probleemstelling nader toegelicht. Vervolgens heb ik in een literatuurstudie uitgevoerd om de belangrijkste factoren te bepalen die nodig zijn om de een antwoord te formuleren op de business vraag. De data hiervoor is vervolgens verzameld en geanalyseerd. Op basis daarvan worden een aantal conclusies getrokken.

# Probleemstelling

De vraag is of we een beter voorspellend model kunnen ontwikkelen voor de huizenprijzen en aantal verkochte woningen.

Zei zijn met de volgende vraagstellingen gekomen:

1. Kunnen we een model ontwikkelen om de huizenprijzen op middellange termijn te voorspellen?

1. Kunnen we een model ontwikkelen om het aantal transacties op de huizenmarkt op middellange termijn te voorspellen?

Vanuit de Volksbank is in het verleden al wel statistisch onderzoek gedaan naar deze vebanden. 
Data wordt verzameld via Datascope (Refinitiv) en geanalyseerd in Excel.

Voor de huizenprijzen is eerder gekeken naar een verband tussen huizenprijzen en de werkgelegenheid, lonen, GDP en rente. Hieruit is een eenvoudig model ontwikkeld waarbij met name het verband met GDP wordt gebruikt om de ontwikkeling van de huizenprijzen te voorspellen. Voor het aantal transacties op de lange termijn wordt een verband verondersteld met het aantal huishoudens. op kortere termijn spelen economische groei, rentestanden en evt. regelgeving ook een rol.

In deze exploratie wil ik kijken naar mogelijke factoren die effect hebben op de marktprijs. Het is in deze fase nog niet de ambitie om ook daadwerkelijk een alternatief model te ontwikkelen voor het voorspellen van de marktprijzen en aantal transacties.

Aanvullend heb ik vooraf een aantal vragen bedacht waar we middels exploratie mogelijk iets meer over te weten kunnen komen:

1. Nederland heeft een van de hoogste persoonlijke schulden (hypotheeklast) in de wereld. Wat zijn de gevolgen voor de hypotheekmarkt van het gewijzigde beleid? Heeft dit effect op de huizenprijzen?

1. Hoe ontwikkeld de krapte op de huizenmarkt zich, op termijn? Momenteel zijn er ambiteuze plannen om ergens tussen de 75.000 en 100.000 woningen per jaar te gaan bouwen. Het aanbod aan huizen wordt dus groter - terwijl op termijn verwacht wordt dat de bevolking weer gaat krimpen. Kunnen we hier een voorspelling van maken?

1. Hoe zit het met de bevolkingsgroei? Welk deel van de aanwas in Nederland komt door migratie? Hoe zit dat regionaal? Is er nog sprake van verstedelijking na corona?  Stroomt het platteland leeg - en de randstad vol? Welk effect heeft dit op de huizenprijzen? 

1. Zien we demografisch verdeeld verschillen waar mensen willen wonen? Verhuizen gezinnen met kinderen naar het platteland, en ouderen weer naar de stad? Het aantal huishoudens dat uit 1 persoon bestaat is erg gegroeid in de loop der tijd - en zal (denk ik) nog wel doorstijgen met de vergrijzing. Betekent dit dat er meer mensen naar de stad willen verhuizen?

1. Hoe afhankelijk is de huizenmarkt van de stand van de economie? Gaan huizenprijzen alleen omhoog tijdens de groeifase van de economie? 

## Plan

Om in ieder geval een begin te maken met het beantwoorden van deze vragen ben ik in gesprek gegaan met de specialisten bij de Volksbank. Aanvullend heb ik een korte literatuurstudie gedaan naar de factoren die op lange termijn de prijsstelling zouden beinvloeden. Het CBS publiceert vrij veel over de prijsonwikkeling van bestaande woningen, nieuwe woningen en de stand van de economie.

In de bijlage is een referentielijst opgenomen met geraadpleegde literatuur. Met name de Socrates modellen sluiten goed aan bij de vraagstelling. 

<!-- Mijn hypotheses: -->

<!-- Krapte bepaald de 'doorstroom' (dus mogelijk weinig transacties); -->
<!-- Levensfase ontwikkeling van 'de Nederlander' bepalend voor de vraag naar type woning; -->
<!-- Het beleid (aflossen van de hypotheek in 30 jaar) heeft lange termijn een prijsopdrijvend effect; -->
<!-- Sentiment speelt op korte termijn (nu toeslaan); -->
<!-- Verstoring woningmarkt door sociale huur, leidt regionaal tot hogere prijzen overige woningen; -->

Op basis van deze eerste inventarisatie ben ik gekomen tot de volgende gewenste informatie. 

```{r}
# # install.packages("kableExtra")
# library(kableExtra)
# library(here)
# 
# 
# tbl_img <- data.frame(
#   name = c("kableExtra 1", "kableExtra 2"),
#   Marktprijs  = "",
#   Transacties = ""
# )
# 
# green <- here("images","green.png")
# red <- here("images","red.png")
# 
# tbl_img %>%
#   kbl(booktabs = T) %>%
#   kable_paper(full_width = F) %>%
#   column_spec(2, image = spec_image(
#     c(green, red), 50, 50)) %>%
#   column_spec(3, image = spec_image(
#     c(red, green), 50, 50))
```

Op langere termijn is de woningmarkt een markt van vraag en aanbod.
Vraag en aanbod worden bepaald door:

:::::: {.columns}
::: {.column width="48%" data-latex="{0.48\textwidth}"}
Vraag woningen:

*	Aantal huishoudens
*	Demografie (omvang en samenstelling huishoudens)
* (Arbeids)migratie
:::
::: {.column width="4%" data-latex="{0.04\textwidth}"}
\ 
:::
:::::: {.column width="48%" data-latex="{0.48\textwidth}"}
Aanbod woningen:

* Woningvoorraad
* Nieuwbouw / Sloop 
* Bouwkosten
* Beschikbaarheid bouwlocaties
* Ruimtelijke ordeningbeleid
:::
::::::
\newline

Daarnaast kunnen meer direct ook andere indicatoren onderzocht worden die van invloed zijn.

:::::: {.columns}
::: {.column width="48%" data-latex="{0.48\textwidth}"}
Indicatoren Huizenprijzen

*	Gem. huizenprijzen (prijsindex)
*	Gem. huurprijzen (berekenen verhouding koop/huur)
*	Percentage huur / koop.
*	Aantal woningen dat te koop staat 
* Gem. duur dat een woning te koop staat
* Besteedbaar Inkomen
* Rentestanden
* Fiscale behandeling, subsidies
* Toegang tot krediet
* Financiering hypotheek of eigen geld
* Voorkeuren van kopers
* Percentage huur / koop woningen
* Consumentenvertrouwen
:::
::: {.column width="4%" data-latex="{0.04\textwidth}"}
\ 
:::
:::::: {.column width="48%" data-latex="{0.48\textwidth}"}
Indicatoren aantal transacties

* Aanbod huizen
* Hypotheek rente
* Toegang tot krediet
* Werkloosheid
* Consumentenvertrouwen
* verschil aanbodprijs en transactieprijs
*	Aantal dagen aangeboden
:::
::::

# Data

De gewenste informatie is opgevraagd bij de statistici (via Reuters Datastream) en later aangevuld met open data van het CBS (Statline). 

Voor het inlezen van de (spreadsheet) Reutersdata heb ik een aantal functies ontwikkeld. Om de data van het CBS gemakkelijker in te kunnen lezen heb ik een routine ontwikkeld die aan de hand van metadata de gevraagde data inleest.

De data is opgeslagen in Rdata formaat - en kan voor de analyse hier worden ingelezen.


```{r}

library (tidyverse)          # standard tidyverse packages
library (here)               # reletive paths for files
library (lubridate)          # Work with dates
library (ggpubr)             # Mix multiple graphs
library (reshape2)           # for easy melting wide format data
library (knitr)              # for outputting data tables
library (kableExtra)         # Nice layout options for data tables
library (viridis)            # Nicer colors for plots
library (forcats)            # for handling categorical data


library(forecast)            # Time series forecasting

#install.packages("fpp2")
library(fpp2)                # Time series forecasting


# Loading the datasets

dfs<-list.files(here("data","tidy"), pattern = "*.Rdata")
for(d in dfs) {
  load(file= here("data","tidy",d ))
}

```

Dit resulteert in vrij veel aparte datasets - met maar een beperkt aantal categorische variabelen.

```{r}
kable(str_replace(dfs, ".Rdata", ""), col.names = NA,)  %>%
  kable_styling()
```

## Analyse 


```{r}
# Kleurcodering grafieken
C_HOUSES = '#9999CC'
C_POPULATION = 'seagreen1'

```

Prijsontwikkeling woningmarkt

```{r}
prijsindex_type_woning %>%
  filter(type_woning != "Totaal woningen") %>%
  filter(type_woning != "EGW") %>%
  ggplot(aes(x=date, y=prijsindex_type_woning)) +
  geom_line(aes(color = type_woning)) +
  theme_minimal() +
  facet_wrap(~ type_woning) +
  labs(
    title = "Prijsindex Bestaande Koopwoningen (PBK)",
    y = "",
    x = '',
    color = 'Type woning'
    ) +
  theme(legend.position = "none")
  
```

We zien kleine verschillen in de type woning. Waarbij met name appartementen de laatste tijd releatief duurder zijn geworden.


Aantal transacties

```{r}
verkochte_woningen_per_type_per_kwartaal %>% 
  mutate(subtype = factor(subtype, levels=c('Vrijstaande woning',
                                  '2-onder-1-kapwoning',
                                  'Hoekwoning',
                                  'Tussenwoning',
                                  'Appartement',
                                  'Onbekend'))) %>% 
  ggplot(aes(x=date, y=verkochte_bestaande_woningen )) +
  geom_line(aes(color = subtype)) +
  theme_minimal() +
  facet_wrap(~ subtype, ncol = 2, scales = "free") +
  labs(
    title = "Verkopen Bestaande Koopwoningen per kwartaal",
    y = "",
    x = '',
    color = 'subtype'
    ) +
  theme(legend.position = "none") 
```

Hier moet ik nog wat met die tijdslijn doen...


```{r}

verkochte_woningen_per_type_per_kwartaal %>% 
  group_by(yearqtr)  %>% 
  summarise(totaal = sum(verkochte_bestaande_woningen)) %>% 
  ggplot(aes(x=yearqtr, y=totaal )) +
  geom_line() +
  geom_smooth() +
  theme_minimal() +
  labs(
    title = "Verkopen Bestaande Koopwoningen per kwartaal",
    y = "",
    x = '',
    color = 'subtype'
    ) +
  theme(legend.position = "none")
  
```

Seizoensinvloeden bij het aantal transacties


Seizoensinvloeden zien we duidelijk terug in de periode voor 2008.
De laatste 10 jaar is dat patroon echter meer verstoord.

https://afit-r.github.io/ts_exploration

```{r}

vw <- verkochte_woningen_per_type_per_kwartaal %>% 
  group_by (yearqtr) %>% 
  summarise(totaal = sum(verkochte_bestaande_woningen))


vwts <- ts(vw["totaal"], 
              start = c(1995, 1), frequency = 4)

vwts %>% 
  ggseasonplot(year.labels=FALSE, continuous=TRUE)

ggsubseriesplot(vwts)

ggAcf(vwts)

```
  




# Vraag naar woningen

Factoren die de vraag naar woningen bepalen.

Aantallen huishoudens + woningen

In onderstaande grafiek zien we dat het aantal woningen al decenia lang gelijke tred houdt met het aantal woningen. Er is daarbij een klein tekort zichtbaar. Dit is veel kleiner dan het gerapporteerde tekort van 331.000 woningen (Staat van de woningmarkt, 2020 https://www.rijksoverheid.nl/actueel/nieuws/2020/06/15/staat-van-de-woningmarkt-2020 ). 


```{r}

#82235NED CBS Aantal Woningen
#Aantal huishoudens: NLHSTOTP Thomson Reuters

# Tidy data 
df <- 
  aantal_huishoudens_per_jaar %>%
  full_join(voorraad_woningen, by = c("date" = "date")) %>%
  select (date, 
          aantal_huishoudens, 
          voorraad) %>%
  set_names('date',
            'huishoudens',
            'woningvoorraad' ) %>%
  mutate(te_kort = (woningvoorraad - huishoudens)) %>%
  filter(date > as.Date("2011-01-01")) %>%
  melt(id = c('date'))

# Line plot
lp<- 
  df %>%
  filter (variable != 'te_kort') %>%
  ggplot(aes (x = date)) +
  geom_line(aes(y=value, color = variable)) +
  labs(
    title = "Aantal huishoudens vs voorraad woningen",
    y = "Aantal (x 1000)",
    x = '',
    color = ''
    ) +
  scale_color_manual(values=c(C_POPULATION,C_HOUSES))

# Bar plot
bp <- 
  df %>%
  filter (variable == 'te_kort') %>%
  ggplot(aes (x = date)) +
  geom_bar(stat = "identity" , 
           aes(y = value, color = variable, fill = variable )) +
  labs ( y = "Te kort (x 1000)",
         x = "",
         color = "", fill = "") +
  theme( axis.text.x = element_blank(),
         axis.ticks = element_blank()) 
  

ggarrange(lp, bp,  
          heights = c(2, 0.7),
          ncol = 1, nrow = 2, align = "v"
          )

```


Demografische ontwikkelingen

Nederlanders worden steeds ouder, en gezinnen worden kleiner. Ontwikkeling leidt mogelijk tot een verschuiving in de vraag - van eensgezinswoningen naar kleinere woningen. Daarnaast komt de groei in Nederlands in steeds grotere mate van migratie.

De prognose van het CBS laat deze trend zien voor de aankomende jaren. Op langere termijn neemt de groei geleidelijk af. Deze cijfers zijn overigens van 2018 - en houden dus nog geen rekening met een afname in de bevolkingsgroei als gevolg van de Corona crisis.


```{r}
prognose_huishoudens %>%
    select (date,
            eenpersoonshuishoudens,
            meerpersoonshuishoudens) %>%
  mutate(eenpersoonshuishoudens = eenpersoonshuishoudens / 1000) %>%
  mutate(meerpersoonshuishoudens =  meerpersoonshuishoudens / 1000 ) %>%
  melt(id = c('date')) %>%
  filter(date <= as.Date("2035-01-01")) %>%
  ggplot(aes (x = date)) +
  geom_line(aes(y=value,  color = variable)) +
  labs(
    title = "Prognose huishoudens",
    y = "Aantal (x 1000)",
    x = ''
    ) 

```

Besteedbaar Inkomen huishoudens

```{r}
inkomen %>%
  filter(kenmerk_huishouden == "Particuliere huishoudens") %>%
  ggplot( aes(x=date, y=besteedbaar_inkomen)) +
  geom_line() +
  labs(
    title = "Besteedbaar inkomen huishoudens",
    y = "Bruto inkomen",
    x = ''
    ) 
```

Vermogen van huishoudens

Het vermogen van huishoudens is de laatste jaren sterk gestegen. 
Dit betreft ook vermogen opgebouwd in de eigen woning. Doordat overwaarde bij verhuizing meestal wordt gebruikt voor de financiering van de woning kan dit een prijsopdrijvend effect hebben.

```{r}
inkomen %>%
  filter(kenmerk_huishouden == "Particuliere huishoudens") %>%
  ggplot( aes(x=date, y=mediaan_vermogen)) +
  geom_line() +
  labs(
    title = "Vermogen huishoudens",
    y = "Mediaan vermogen",
    x = ''
    ) 
```

Rente stand

De rente is historisch laag. De lage rentestand maakt lenen goedkoper. Wat een prijsopdrijvend effect kan hebben op de huizenprijzen.


```{r}
hypotheek_rente %>%
  ggplot( aes(x=period, y=hypotheek_rente)) +
  geom_line()  +
  labs(
    title = "Hypotheekrente",
    y = "gemiddelde rente",
    x = ''
    ) 

```

Betaalbaarheid huizen

Statline geen goede bron...


Financiering huizen (inleg eigen geld)




Hypotheek

Nog altijd een groot deel van de woonhuizen in Nederland wordt gefinancieerd met een hypotheek.


Consumer confidence...



# Aanbod van Woningen...


Landelijk zien we ook een fors aantal leegstaande woningen. 
Mogelijk is er meer sprake van een mismatch in type woning, of regionaal effect.

```{r}

# Zo'n 340.000 niet bewoonde huizen...

voorraad_woningen_naar_eigendom %>%
select(date, status_bewoning, totale_woningvoorraad) %>%
filter (status_bewoning =='Niet bewoonde woningen') %>%
mutate(totaal = totale_woningvoorraad / 1000) %>%
ggplot(aes (x = date)) +
geom_line(aes(y=totaal, color = status_bewoning)) +
labs(
    title = "Aantal huizen onbewoond",
    y = "Aantal (x 1000)",
    x = 'Jaar',
    color = ''
    )

```

Te koop staande huizen...

Gem. aanbodtijd...

Verschil tussen vraagprijs en koopprijs


Woningvoorraad

Meer dan de helft van de woningen in Nederland zijn koopwoningen. 
De tijdreeks van deze gegevens is helaas vrij kort. In de afgelopen jaren zien we weinig verschuivingen in deze verhoudeningen.

```{r}
voorraad_woningen_naar_eigendom %>%
  filter (status_bewoning =='Totaal') %>%
  filter( date == as.Date("2020-01-01")) %>%
  select(date, 
       koopwoningen,
       eigendom_woningcooperatie, 
       overige,
       eigendom_onbekend ) %>%
  melt(id = c("date")) %>%
  mutate(value = value / 1000) %>%
  ggplot(aes (x = reorder(variable , value))) +
  geom_bar(stat = "identity" , aes(y = value, fill = variable)) +
  coord_flip() +
  labs(
    title = "Aantal woningen naar eigendom 2020",
    y = "Aantal (x 1000)",
    x = ''
    ) + 
  theme(legend.position = "none")
```

Toevoegingen door Nieuwbouw 

Wanneer we een wat langere termijn trend kijken naar het aantal gerealiseerde nieuwbouwhuizen zien we dat het aantal nieuwbouwhuizen eingelijk nu niet bijzonder hoog is. Ondanks dat er meer dan 70.000 huizen bijgebouwd wordt per jaar is dat vergeleken met de totale woningvoorraad eigenlijk niet veel. We zagen al dat de woningvoorraad lange termijn tred houdt met het aantal huishoudens.

```{r}
voorraad_woningen %>%
  select(date,
         nieuwbouw) %>%
  mutate(nieuwbouw = nieuwbouw / 1000) %>%
  filter(date > as.Date("1980-01-01")) %>%
  ggplot(aes(x=date, y = nieuwbouw )) +
  geom_line(color = c(C_HOUSES)) +
  labs ( title = "Toevoegingen door Nieuwbouw",
         y = "Aantal (x 1000)",
         x = "Jaar") 
```


Nieuwbouw

https://opendata.cbs.nl/statline/#/CBS/nl/dataset/81955NED/table?fromstatweb

gegevens per maand, per regio 

```{r}
nieuwbouw_per_regio %>%
  filter(region == "Nederland") %>%
  ggplot(aes(x=period, y = value )) +
  geom_line() +
  theme(legend.position = "bottom") 
```

--- evt. prognose nieuwbouw toevoegen ---

Bouwkosten

De prijzen van nieuwbouw zijn ten opzichte van bestaande woningen de laatste tijd harder gestegen. Een belangrijke factor hiervoor zouden de bouwkosten zijn.

* _Beschikbaarheid bouwlocaties_
* _Ruimtelijke ordeningbeleid_

aanbod woningen tov aantal verkocht

Regionaal zijn er grote verschillen, hier ga ik later nog even op in.



```{r}
prijsindex_per_regio %>%
  filter(region != "Nederland")  %>%
  filter(grepl('PV', region)) %>%
  ggplot(aes(x=date )) +
  geom_line(aes(y=prijsindex_bestaande_koopwoningen, color = region)) +
  theme(legend.position = "bottom") +
  labs(title = "Prijsindex Nederland") +
  facet_wrap(~region)
```


```{r}
# prijsindex_woningen %>%
#   full_join(consumenten_aankoopintentie, by="yearqtr") %>%
#   ggplot(aes(x=date )) +
#   geom_line(aes(y=house_price_index)) +
#   geom_line(aes(y=home_purchase_intention)) +
#   theme(legend.position = "bottom") +
#   labs(title = "Prijsindex bestaande woningen")  

```


```{r}
# aanbod_huizen %>%
#   filter(set == "Totaal") %>%
#   ggplot(aes(x=datum )) +
#   geom_line(aes(y=vraagprijs)) +
#   theme(legend.position = "bottom") +
#   labs(title = "Vraagprijs woningen")  
```

```{r}
# aanbod_huizen %>%
#   filter(set != "Totaal") %>%
#   ggplot(aes(x=datum )) +
#   geom_line(aes(y=aantal, color = set)) +
#   theme(legend.position = "bottom")
```


```{r}
# aanbod_huizen %>%
#   filter(type != "Totaal") %>%
#   ggplot(aes(x=datum )) +
#   geom_line(aes(y=aanbodtijd, color = set)) +
#   theme(legend.position = "bottom")
```


Hypotheek rente

```{r}
# hypotheek_rente  %>%
#   ggplot(aes(x=period, y = mortgage_interest )) +
#   geom_line()
```


Aantal transacties

<!-- ```{r} -->
<!-- transacties_per_type %>% -->
<!--   ggplot(aes(x=monthly , y=aantal_verkocht, color= type_woning, fill = type_woning)) + -->
<!--   geom_bar(stat="identity") + -->
<!--   theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") + -->
<!--   labs(x = "", y = "", title = "Aantal verkocht per type") -->
<!-- ``` -->

Transacties per leeftijd - sluit niet aan op het aantal verkochte woningen...

```{r}
transacties_per_leeftijd %>%
  ggplot(aes(x=period , y=aantal_transacties, color= leeftijd, fill = leeftijd)) +
  geom_bar(stat="identity") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
  labs(x = "", y = "", title = "Aantal Transacties per maand per leeftijdscategorie" )  
```

verkochte_woningen_per_provincie_per_maand %>%
  
Regionale verschillen

# Conclusies

 Deze is ook leuk:

 https://www.youtube.com/watch?v=5UvrPO4eY5A&feature=emb_logo
 
 
# Referenties

Voor dit onderzoek heb ik de onder andere de volgende bronnen geraadpleegd:

https://www.cpb.nl/publicatie/oververhitting-op-de-nederlandse-huizenmarkt/CPB-Achtergronddocument-1jun2018-Oververhitting-op-de-nederlandse-huizenmarkt.pdf

https://datawonen.nl/dashboard/dashboard/koopprijs

https://primos.datawonen.nl/

https://www.cbs.nl/nl-nl/achtergrond/2016/16/indicatoren-woningmarkt-op-groen

https://www.cbs.nl/nl-nl/visualisaties/monitor-koopwoningmarkt

https://www.cbs.nl/nl-nl/visualisaties/huizenmarkt-in-beeld

https://www.rijksoverheid.nl/documenten/rapporten/2019/05/29/socrates-2019---scenarioverkenningen-van-de-woningmarkt-in-2030

https://www.abfresearch.nl/publicaties/vooruitzichten-bevolking-huishoudens-en-woningmarkt-2020-2035/#:~:text=Volgens%20de%20Primos%20Prognose%202020,1%25%2C%20418%20duizend%20woningen.

 